:root {
    --primary: #4f46e5;
    --bg: #f8fafc;
    --text: #1e293b;
    --text-light: #64748b;
    --white: #ffffff;
    --danger: #ef4444;
    --shadow: 0 4px 15px rgba(0,0,0,0.1);
}

* { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; -webkit-tap-highlight-color: transparent; }

/* CẤU TRÚC CHÍNH: DÙNG 100dvh ĐỂ KHỚP MÀN HÌNH ĐIỆN THOẠI */
body { 
    background-color: var(--bg); 
    color: var(--text); 
    height: 100vh; 
    height: 100dvh; /* Chiều cao động, trừ đi thanh URL trình duyệt */
    overflow: hidden; /* Không cho cuộn body, chỉ cuộn thành phần con */
    display: flex;
    flex-direction: column;
}

.hidden { display: none !important; }

/* --- LOGIN SCREEN (Giữ nguyên, phủ lên trên cùng) --- */
#login-screen {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: linear-gradient(135deg, #eef2ff, #e0e7ff);
    display: flex; justify-content: center; align-items: center; z-index: 9999;
}
.login-content { text-align: center; width: 85%; }
.login-logo { width: 120px; height: 120px; border-radius: 50%; border: 4px solid white; box-shadow: var(--shadow); margin-bottom: 20px; }
.login-content h1 { color: var(--primary); margin-bottom: 20px; }
.login-input-group { display: flex; background: white; padding: 5px; border-radius: 30px; box-shadow: var(--shadow); }
.login-input-group input { flex: 1; border: none; padding: 12px 20px; outline: none; font-size: 1rem; border-radius: 30px; }
.login-input-group button { width: 45px; height: 45px; border-radius: 50%; border: none; background: var(--primary); color: white; font-size: 1.2rem; }
#login-error { color: var(--danger); margin-top: 15px; font-weight: bold; }

/* --- APP CONTAINER (CHIA CỘT DỌC) --- */
#app-screen {
    display: flex;
    flex-direction: column; /* Xếp chồng Header và List */
    height: 100%;
    width: 100%;
    overflow: hidden;
}

/* 1. APP HEADER (CỐ ĐỊNH Ở TRÊN) */
/* Không dùng position: fixed nữa, dùng flex để nó chiếm vị trí đầu tiên */
.app-header {
    flex: 0 0 auto; /* Không co giãn, chiều cao theo nội dung */
    height: 80px;
    background: white; 
    display: flex; 
    align-items: center; 
    padding: 0 15px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05); 
    gap: 12px;
    z-index: 50;
}
.app-header button { background: none; border: none; font-size: 1.5rem; color: var(--text); padding: 5px; cursor: pointer; }
.search-bar {
    flex: 1; background: #f1f5f9; height: 46px; border-radius: 23px;
    display: flex; align-items: center; padding: 0 15px;
    border: 1px solid transparent;
}
.search-bar:focus-within { border-color: var(--primary); background: white; }
.search-bar input { flex: 1; background: transparent; border: none; outline: none; margin-left: 10px; font-size: 1rem; }

/* 2. FILE LIST CONTAINER (CUỘN Ở DƯỚI) */
/* Chiếm toàn bộ khoảng trống còn lại */
.file-list-container { 
    flex: 1; /* Chiếm hết phần còn lại bên dưới header */
    overflow-y: auto; /* Chỉ cuộn khu vực này */
    padding: 20px 15px 90px 15px; /* Padding bottom lớn để tránh nút FAB */
    -webkit-overflow-scrolling: touch; /* Cuộn mượt trên iOS */
}

.list-header { font-size: 0.9rem; color: var(--text-light); margin-bottom: 15px; font-weight: 500; }
#file-list { list-style: none; }

.file-item {
    background: white; border-radius: 16px; padding: 15px; margin-bottom: 12px;
    display: flex; align-items: center; gap: 15px; 
    box-shadow: 0 2px 8px rgba(0,0,0,0.03);
}
.file-item:active { transform: scale(0.98); background-color: #f1f5f9; }

.file-icon { font-size: 2rem; }
.file-info { flex: 1; overflow: hidden; }
.file-name { 
    font-weight: 600; font-size: 1rem; color: var(--text); 
    text-decoration: none; display: block;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis; 
    margin-bottom: 4px;
}
.file-tags { display: flex; gap: 6px; overflow-x: auto; padding-bottom: 2px; }
.tag-badge { font-size: 0.75rem; background: #e0e7ff; color: var(--primary); padding: 3px 10px; border-radius: 12px; white-space: nowrap; font-weight: 500; }
.menu-dots { padding: 10px; color: var(--text-light); font-size: 1.2rem; cursor: pointer; }

/* --- CÁC THÀNH PHẦN KHÁC (GIỮ NGUYÊN) --- */

/* DRAWER (SIDEBAR) */
#drawer-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 199; }
#app-drawer {
    position: fixed; top: 0; left: -280px; width: 280px; height: 100%;
    background: white; z-index: 200; transition: 0.3s ease-out; display: flex; flex-direction: column;
    box-shadow: 4px 0 15px rgba(0,0,0,0.1);
}
#app-drawer.open { left: 0; }
.drawer-header { padding: 25px 20px; background: var(--primary); color: white; display: flex; align-items: center; gap: 15px; font-size: 1.3rem; font-weight: bold; }
.drawer-header img { width: 45px; height: 45px; border-radius: 50%; border: 2px solid white; }
.drawer-content { padding: 20px; overflow-y: auto; flex: 1; }
.filter-section { margin-bottom: 25px; }
.filter-section h3 { font-size: 0.9rem; color: var(--text-light); margin-bottom: 12px; text-transform: uppercase; letter-spacing: 1px; font-weight: 600; }
.chip-container { display: flex; flex-wrap: wrap; gap: 8px; }
.filter-chip {
    padding: 8px 16px; border-radius: 20px; border: 1px solid #e2e8f0; font-size: 0.9rem;
    background: white; color: var(--text); transition: 0.2s;
}
.filter-chip.active { background: var(--primary); color: white; border-color: var(--primary); box-shadow: 0 2px 5px rgba(79, 70, 229, 0.3); }

/* FAB BUTTON */
#fab-upload {
    position: fixed; bottom: 25px; right: 25px; width: 60px; height: 60px;
    border-radius: 50%; background: var(--primary); color: white; border: none;
    font-size: 1.6rem; box-shadow: 0 4px 20px rgba(79, 70, 229, 0.4); z-index: 90;
    display: flex; align-items: center; justify-content: center;
    transition: transform 0.2s;
}
#fab-upload:active { transform: scale(0.9); }

/* MODALS & SHEETS */
.modal {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.6); z-index: 300; display: flex; align-items: center; justify-content: center;
    backdrop-filter: blur(2px);
}
.modal-content { background: white; width: 90%; max-width: 400px; border-radius: 20px; padding: 25px; animation: popUp 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
.modal-content h3 { margin-bottom: 20px; color: var(--primary); font-size: 1.2rem; text-align: center; }

/* Upload Styles */
.file-select-area { border: 2px dashed #cbd5e1; border-radius: 16px; padding: 25px; text-align: center; margin-bottom: 20px; background: #f8fafc; }
.file-label { display: flex; flex-direction: column; color: var(--text-light); gap: 10px; align-items: center; }
.file-label i { font-size: 2.5rem; color: var(--primary); }
.tag-input-area { margin-bottom: 25px; }
.input-row { display: flex; gap: 8px; margin-bottom: 10px; }
.input-row input { flex: 1; padding: 12px; border: 1px solid #e2e8f0; border-radius: 10px; outline: none; font-size: 1rem; }
.input-row input:focus { border-color: var(--primary); }
.input-row button { background: var(--primary); color: white; border: none; padding: 0 18px; border-radius: 10px; font-size: 1.2rem; }
.tags-list { display: flex; flex-wrap: wrap; gap: 8px; min-height: 30px; }
.modal-actions { display: flex; gap: 12px; }
.btn-cancel, .btn-confirm { flex: 1; padding: 14px; border: none; border-radius: 12px; font-weight: bold; font-size: 1rem; }
.btn-cancel { background: #f1f5f9; color: var(--text); }
.btn-confirm { background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(79, 70, 229, 0.2); }

/* Action Sheet */
.sheet-content {
    position: absolute; bottom: 0; width: 100%; background: white;
    border-radius: 24px 24px 0 0; padding: 10px 20px 30px 20px; animation: slideUp 0.3s ease-out;
}
.sheet-content h3 { text-align: center; padding: 15px; border-bottom: 1px solid #f1f5f9; margin-bottom: 10px; font-size: 1.1rem; color: var(--text); max-width: 90%; margin: 0 auto; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}

.sheet-btn {
    display: flex; align-items: center; width: 100%; padding: 16px; border: none; background: none;
    text-align: left; font-size: 1.1rem; border-bottom: 1px solid #f8fafc;
    text-decoration: none; color: var(--text); font-weight: 500;
}
.sheet-btn i { width: 40px; text-align: center; margin-right: 10px; font-size: 1.2rem; }
.sheet-btn.delete { color: var(--danger); }
.sheet-btn.cancel { justify-content: center; border: none; color: var(--text-light); margin-top: 15px; background: #f1f5f9; border-radius: 12px; font-weight: bold; }

.full-input { width: 100%; padding: 14px; border: 1px solid #ddd; border-radius: 10px; margin-bottom: 20px; font-size: 1rem; outline: none; }
.full-input:focus { border-color: var(--primary); }

/* Colors Icons */
.fa-file-word { color: #2b579a; }
.fa-file-excel { color: #217346; }
.fa-file-powerpoint { color: #d24726; }
.fa-file-pdf { color: #8e4